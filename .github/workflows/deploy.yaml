name: Deploy to static-sites server

on: [push]

jobs:
  build:
    name: Deploy
    runs-on: ubuntu-latest
    steps:

    - name: Deploy the statics
      uses: appleboy/ssh-action@v0.1.5
      with:
        host: ${{ secrets.STATIC_HOST }}
        username: ${{ secrets.STATIC_USERNAME }}
        key: ${{ secrets.SSH_KEY }}
        port: ${{ secrets.STATIC_PORT }}
        script: |
          docker ps -aq --filter "name=crypter" | xargs -r docker rm
          docker run -d --name crypter -p 8080:8080 ghcr.io/infiniteloopcloud/crypter:v0.1.0